% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/collapse_mrr_list.R
\name{collapse_mrr_list}
\alias{collapse_mrr_list}
\title{Collapse Per-File MRR Results into Combined Sessions and Events}
\usage{
collapse_mrr_list(mrr_list, pdvs = c("drop", "attach"))
}
\arguments{
\item{mrr_list}{Named list of per-file MRR objects (output of \code{\link{get_file_data}}),
typically from \code{\link{download_mrr_files}}. Names should be filenames.
Each element must contain \code{session} and \code{events}. If PDVs were retained
upstream, elements also contain \code{session_pdv_fields}, \code{detail_pdv_fields},
and \code{pdv_values}.}

\item{pdvs}{Character; one of \code{"drop"} (default) or \code{"attach"}.
If \code{"drop"}, return only \code{sessions} and \code{events}.
If \code{"attach"}, attach \code{spdv*}/\code{pdv*} code columns when available,
and return \code{pdv_map}.}
}
\value{
A list with:
\itemize{
\item \code{sessions}: tibble with one row per file/session (optionally with \code{spdv*} columns)
\item \code{events}: tibble of all event rows (optionally with \code{pdv*} columns)
\item \code{pdv_map}: tibble mapping (only when \code{pdvs="attach"})
}
The \code{pdv_map} contains \code{file_name}, \code{level} (session/event),
\code{pdv_column}, \code{label_raw}, \code{label} (cleaned), and \code{definition}.
}
\description{
Collapse a named list of per-file parsed PTAGIS mark–recapture–recovery (MRR)
results (typically from \code{\link{download_mrr_files}}) into two combined tibbles:
\code{sessions} (one row per file) and \code{events} (all event rows).

If \code{pdvs = "attach"} and PDV values were retained upstream (i.e.,
the per-file objects include \code{pdv_values}), SPDV values are attached to
\code{sessions} in wide format (\code{spdv1}, \code{spdv2}, ...), and PDV values
are attached to \code{events} in wide format (\code{pdv1}, \code{pdv2}, ...).
In that case, a per-file \code{pdv_map} is also returned, mapping PDV code columns
to cleaned labels and definitions.
}
\author{
Mike Ackerman
}
